---
title: 域
---

## 简介

域功能类似团队，允许在一套系统中创建多个环境（如不同班级，或是不同功能，等等）  
用户可以创建多个域。（需要用户有 PRIV_CREATE_DOMAIN 权限，默认仅开放给管理员账户）。
域间数据完全独立，仅用户信息相通（注册账户后，在该实例的所有域中均有效）。  

## 创建域

登录账号后，在“我的”选项卡中找到“我的域”，并点击“创建域”，填入以下信息：

- ID： 每个域有一个唯一的 ID，将会在域 URL 中体现。**创建后无法修改。**
- 名称： 域的名字，创建后可以更改。
- 公告： 域主页上显示的公告，创建后可以更改。
- avatar： 域头像，与用户头像同理，可以使用 `gravatar:email` 或 `qq:id` 或 `github:name` 或 `url:link` 的格式添加。将会在“我的域”界面内显示。

创建域后，您将在此域中拥有管理员权限，可以在域内进行添加题目/创建比赛等操作。

## 初始化讨论节点

您可以在“管理域”选项卡中点击“初始化讨论节点”按钮初始化讨论节点。

## 访问控制

### Hydro v5

Hydro v5 开始，未登录的用户和未加入域的用户在域内默认 `guest` 权限，加入域的用户默认使用 `default` 权限。  
您可以在加域管理中设置 允许用户自助加入域，分配 default 权限。以获得和 v4 相同的权限效果。  
在 v5 中，只有加域用户会显示在域排行榜中。  
域管理员修改特定用户的权限为除 `default` 或 `guest` 之外的权限后，该用户加入域时将可以绕过其他条件要求，并在加入域时自动应用分配的角色。  
将用户的权限显式设置为 `guest` 可以防止用户使用自助加域功能加入域。  
加域后可以主动退出或被管理员踢出域，此时用户权限组还原为 `guest`，直至再次加入域。  
只有已经加入的域会在 “我的域” 中显示。用户注册后会自动加入 `system` 域，并不可主动退出。  

在 Hydro v4 至 Hydro v5 的升级过程中，将执行以下操作：

- 标记所有现有用户为已加入  
- 将未设置加域条件与设置为没有用户可以自助加入的域设置为允许所有用户自助加入，权限分配为 `default`

### Hydro v4

**未登录用户将默认使用 `guest` 权限，登录用户将默认使用 `default` 权限。**（所以将登陆用户设为 `default` 权限后并不会显示在“管理用户”页内，这也表示所有用户默认不会出现在管理列表中）  
所以将一个用户的权限设为 `default` 和将用户移出该域是等价的。

对于不在列表中的用户，点击右上角“添加用户”，在左侧选中用户，右侧选择权限组，再点击“确定”即可。

## 创建比赛/作业

若您想要创建比赛/作业，您可以在“比赛”或“作业”选项卡中，在页面右侧找到“创建”按钮，
题目一栏支持根据题目ID或是题目名自动筛选。设置完后可点击“创建”按钮创建比赛（描述这类的框不知道写啥就随便填，不能留空）。

<Callout>
若因为删除作业/比赛内题目导致无法打开，可以通过 `/contest/<id>/edit` 或 `/homework/<id>/edit`（即在无法打开的页面页面后加上 `/edit`）直接访问编辑页并修正。
</Callout>

## 创建训练

若您想要创建训练，您可以在“训练” 项卡中点击“新建训练计划”，填写以下信息：

- 标题：该训练的标题；
- 简介：该训练的简介，会与标题同时显示在列表页面中；
- 说明：该训练的详细信息；
- 计划：该训练的具体题目及计划信息，其格式如下：

```
[
  {章节详细信息},
  {章节详细信息},
  ...
  {章节详细信息}
]
```

其中，“章节详细信息”的包含以下部分：

- `_id`：章节数字编号；
- `title`：章节标题；
- `requireNids`：训练此章节之前需要完成的章节数字编号，若无要求则留空，若有多个则使用逗号分隔；
- `pids`：此章节中包含的题目的 **ID**，若有多个则使用逗号分隔。

**举例**：若要在训练中创建三个章节，章节中分别有 **ID** 为 1，2，3 的题目。其中章节一、二无前置条件，章节三需要同时完成章节一、二后才能进行，则格式如下：

```json
[
  {
    "_id": 1,
    "title": "入门",
    "requireNids": [],
    "pids": [1]
  },
  {
    "_id": 2,
    "title": "精通",
    "requireNids": [],
    "pids": [2]
  },
  {
    "_id": 3,
    "title": "大师",
    "requireNids": [1,2],
    "pids": [3]
  }
]
```

<Callout>
若因为删除训练计划内题目导致训练计划无法打开，可以通过 `/training/<id>/edit`（即训练计划页面后加上 `/edit`）直接访问训练计划编辑页并修正配置文件。
</Callout>
